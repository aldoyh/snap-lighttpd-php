name: iotdevice-http # you probably want to 'snapcraft register <name>'
base: core22 # the base snap is the execution environment for this snap
version: '0.1' # just for humans, typically '1.2+git' or '1.3.2'
summary: A simple IOT Demo web server for wrapper
description: |
  Reboot of the lighttpd snap

grade: stable # must be 'stable' to release into candidate/stable channels
confinement: strict # use 'strict' once you have the right plugs and slots

apps:
  iotdevice-lighttpd:
    command: run-lighttpd
    daemon: simple
    plugs: [network, network-bind]
  lighty-enable-mod:
    command: usr/sbin/lighty-enable-mod
    daemon: simple
    plugs: [network, network-bind]


parts:
  iotdevice-http:
    plugin: nil
    organize:
      usr/bin/php-cgi.default: /usr/bin/php-cgi
    stage-packages:
            - lighttpd
            - spawn-fcgi
            - php
            - php-cgi
  copy:
    plugin: nil
    source: .
    override-build: |
      cp -av run-lighttpd $SNAPCRAFT_PART_INSTALL
    after: [iotdevice-http]
